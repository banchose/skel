# Just a personal .bashrc that maybe renamed and then included in the real ~/.bashrc
# in ~/.bashrc: [[ -f ~/.bashrc.includeme ]] && source ~/.bashrc.includeme

# echo "${BASH_SOURCE[0]}"

# export TERM=xterm
export TERM=xterm-256color

######################################
# Set the editor and editor alias
######################################
command_exists() {
  command -v "$1" 1>&2 >/dev/null
}

if command_exists nvim 1>&2 >/dev/null; then
  export EDITOR=nvim
  alias v='nvim'
elif command_exists vim; then
  export EDITOR=vim
  alias v='vim'
elif command_exists vi; then
  export EDITOR=vi
  alias v='vi'
elif command_exists nano; then
  export EDITOR=nano
  alias v='nano'
else
  echo "NO EDITOR FOUND"
fi

export LESS="-iMFXRj4Q"

# Since switching to set -o vi... Control D logs me out so now have to do 4 times

# set -o vi
# bind -m vi-command ".":yank-last-arg # or insert-last-argument
# bind '"jj":vi-movement-mode'

export IGNOREEOF=4
# export PS1="\[$(tput setaf 7)\][\!]\[$(tput setaf 47)\][\H]\[$(tput setaf 3)\][\u]\[$(tput setaf 8)\][\D{%F %T}]\[$(tput setaf 2)\][\w]\n\[$(tput setaf 7)\][\$?][\v]\$ \[$(tput sgr0)\]"
# the git broke sudo bash export PS1="\[$(tput setaf 7)\][\!]\[$(tput setaf 47)\][\H]\[$(tput setaf 3)\][\u]\[$(tput setaf 8)\][\D{%F %T}]\[$(tput setaf 2)\][\w]\n\[$(tput setaf 7)\][\$?][\[$(tput setaf 9)\]\$(parse_git_branch)\[$(tput setaf 7)\]][\v]\$ \[$(tput sgr0)\]"
PS1="\[$(tput setaf 7)\][\!]\[$(tput setaf 47)\][\H]\[$(tput setaf 3)\][\u]\[$(tput setaf 8)\][\D{%F %T}]\[$(tput setaf 2)\][\w]\n\[$(tput setaf 7)\][\$?]\[$(tput setaf 7)\][\v]\$ \[$(tput sgr0)\]"
# Make info friendly
minfo() { info "$1" --subnodes -o - 2>/dev/null | "$PAGER"; }

checkip() {
  exec 3<>/dev/tcp/checkip.amazonaws.com/80
  printf "GET / HTTP/1.1\r\nHost: checkip.amazonaws.com\r\nConnection: close\r\n\r\n" >&3
  tail -n1 <&3
}

set -o noclobber

PROMPT_DIRTRIM=10

shopt -s globstar 2>/dev/null
shopt -s checkwinsize
shopt -s nocaseglob
shopt -s histverify
shopt -s histappend
shopt -s cmdhist
shopt -s autocd 2>/dev/null
shopt -s dirspell 2>/dev/null
shopt -s cdspell 2>/dev/null
shopt -s cdable_vars
shopt -s lithist
export HISTSIZE=50000
export HISTFILESIZE=10000
export HISTCONTROL="ignorespace:erasedups"
export HISTIGNORE="&:[ ]*:exit:ls:bg:fg:history:clear"
export HISTTIMEFORMAT='%F %T '

CDPATH=".:~:"

alias chown='chown --preserve-root'
alias iptables='iptables -v'
alias wget='wget -c'
alias bc='bc -l'
alias path='echo -e ${PATH//:/\\n}'
alias dmesg='dmesg --color=always'
alias chmod='chmod --preserve-root'
alias chgrp='chgrp --preserve-root'
alias now='date +"%T"'
alias cp='cp -i -v'
alias grep='grep -i --color=auto'
alias mv='mv -i -v'
alias rm='rm -v -I --preserve-root'
alias df='df -H'
alias g='grep'
alias du='du -ch'
alias ls='ls -ltrFh --color=auto'
alias l='ls -l -aF'
alias ll='ls -AFlSrh --color=auto --group-directories-first'
alias j='jobs -l'
alias ltr='ls -AFltrh --color=auto'

# Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0
alias acurl='curl -L -s -A "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:139.0) Gecko/20100101 Firefox/139.0"'
alias xlsblk='lsblk -o name,mountpoint,fstype,size,fsused,pttype,model,vendor,serial,uuid,partuuid'

alias nsps='ps -eo pid,ppid,pgid,sess,stat,tty,pidns,utsns,ipcns,mntns,netns,cmd'
alias pps='ps -eo pid,ppid,pgid,sess,stat,tty,tpgid,uname,%cpu,%mem,cmd'
alias nps='ps -N --ppid 2 -o pid,ppid,pgid,sess,stat,tty,tpgid,uname,%cpu,%mem,cmd'

# Ensure the directory variable is not empty
home_bashrc_directory=~/.bashrc_zen.d

if [[ -d "${home_bashrc_directory}" ]]; then
  echo "Running scripts in ${home_bashrc_directory}"
  for profile in "${home_bashrc_directory}/"*.sh; do
    if [[ -r "$profile" ]]; then
      echo "Sourcing: $profile"
      . "$profile"
    else
      echo "Cannot read $profile, skipping..."
    fi
  done
else
  echo "Directory ${home_bashrc_directory} does not exist."
fi

#if command -v aws_completer &>/dev/null; then
# complete -C "$(command -v aws_completer)" aws
#fi

## Appended for py1
# alias ipython=ipython3
# eval "$(register-python-argcomplete pipx)"
# BEDROCK_MODEL='bedrock/us.anthropic.claude-sonnet-4-5-20250929-v1:0'

export PATH="$HOME/.local/bin:$PATH"
export PATH="$HOME/.cargo/bin:$PATH"
export PATH="$HOME/go/bin:$PATH"
export PATH="/usr/local/go/bin:$PATH"
[ -s "$HOME/.nvm/nvm.sh" ] && source "$HOME/.nvm/nvm.sh"

BEDROCK_MODEL='us.anthropic.claude-sonnet-4-5-20250929-v1:0'
llm() {
  if [[ -z "${AWS_BEARER_TOKEN_BEDROCK}" ]]; then
    echo "Error: AWS_BEARER_TOKEN_BEDROCK is not set" >&2
    return 1
  elif [[ "${AWS_BEARER_TOKEN_BEDROCK}" == DUMMY* ]]; then
    echo "Error: AWS_BEARER_TOKEN_BEDROCK contains DUMMY placeholder - replace with real API key" >&2
    return 1
  fi
  PROMPT="The time is: $(date). Please be percise and concise. If you don't know something say so.  If you could produce a better answer with key information I may be able to provide, ask for it"
  command llm -s "${PROMPT}" -m "${BEDROCK_MODEL}" "$@"
}

# export MANPAGER='nvim +Man!'
eval "$(register-python-argcomplete pipx)"
